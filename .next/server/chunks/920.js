"use strict";exports.id=920,exports.ids=[920],exports.modules={5920:(e,r,s)=>{s.d(r,{$1:()=>h,I8:()=>u,IG:()=>k,LG:()=>g,Oy:()=>y,Rf:()=>p,UJ:()=>d,WL:()=>m,_p:()=>b,c0:()=>f,db:()=>c,mU:()=>w,rl:()=>U});var t=s(2585),n=s(76),i=s(4856),a=s(1552);s(32);let o=(0,t.ZF)({apiKey:"AIzaSyB7tnzEzeRBqQ1JL8aNgRe2PPuOS0Mt5Ms",authDomain:"sheen-termin.firebaseapp.com",projectId:"sheen-termin",storageBucket:"sheen-termin.firebasestorage.app",messagingSenderId:"531525100411",appId:"1:531525100411:web:59b8c142e3deca949613de",measurementId:"G-F69XYP1FV5"}),c=(0,n.ad)(o),u=(0,i.v0)(o),l=(0,a.cF)(o);async function d(e,r,s){try{let t=(await (0,i.Xb)(u,e,r)).user,a=s.profileImageUrl;return await (0,i.ck)(t,{displayName:`${s.firstName} ${s.lastName}`,photoURL:a||null}),await (0,n.ET)((0,n.hJ)(c,"customers"),{uid:t.uid,firstName:s.firstName,lastName:s.lastName,phone:s.phone,email:s.email,birthdate:s.birthdate,profileImageUrl:a||null,createdAt:n.Timestamp.now(),updatedAt:n.Timestamp.now()}),{success:!0,uid:t.uid}}catch(e){if(console.error("Fehler bei der Kundenregistrierung:",e),e instanceof Error){let r=e.message;if(r.includes("auth/email-already-in-use"))return{success:!1,error:"auth/email-already-in-use"};if(r.includes("auth/weak-password"))return{success:!1,error:"Das Passwort ist zu schwach. Bitte w\xe4hlen Sie ein st\xe4rkeres Passwort."};if(r.includes("auth/invalid-email"))return{success:!1,error:"Die E-Mail-Adresse ist ung\xfcltig. Bitte geben Sie eine g\xfcltige E-Mail-Adresse ein."};return{success:!1,error:r}}return{success:!1,error:"Unbekannter Fehler bei der Registrierung"}}}async function m(e,r){try{let s=await (0,i.e5)(u,e,r);return{success:!0,user:s.user}}catch(e){return console.error("Fehler bei der Anmeldung:",e),{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}async function h(){try{return await (0,i.w7)(u),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}async function f(e){try{let r={url:`${window.location.origin}/login`,handleCodeInApp:!1};return console.log("Reset-Link wird gesendet an:",e),console.log("Mit Weiterleitung zu:",r.url),await (0,i.LS)(u,e,r),console.log("Reset-Link erfolgreich gesendet"),{success:!0}}catch(e){if(console.error("Fehler beim Senden des Reset-Links:",e),e instanceof Error){let r=e.message||"";if(r.includes("auth/user-not-found"))return{success:!1,error:"Es wurde kein Konto mit dieser E-Mail-Adresse gefunden."};if(r.includes("auth/invalid-email"))return{success:!1,error:"Die eingegebene E-Mail-Adresse ist ung\xfcltig."};if(r.includes("auth/too-many-requests"))return{success:!1,error:"Zu viele Anfragen. Bitte versuchen Sie es sp\xe4ter erneut."};return{success:!1,error:r}}return{success:!1,error:"Ein unbekannter Fehler ist aufgetreten. Bitte versuchen Sie es sp\xe4ter erneut."}}}async function g(e,r){try{if(!e||""===e.trim())return console.error("Leerer oobCode bei confirmPasswordReset"),{success:!1,error:"Der Reset-Code fehlt oder ist ung\xfcltig. Bitte fordern Sie einen neuen Reset-Link an."};if(!r||r.length<8)return{success:!1,error:"Das Passwort muss mindestens 8 Zeichen lang sein."};return await (0,i.LG)(u,e,r),console.log("Passwort erfolgreich zur\xfcckgesetzt"),{success:!0}}catch(e){if(console.error("Fehler beim Zur\xfccksetzen des Passworts:",e),e instanceof Error){let r=e.message||"";if(r.includes("auth/invalid-action-code")||r.includes("auth/expired-action-code"))return{success:!1,error:"Der Reset-Link ist ung\xfcltig oder abgelaufen. Bitte fordern Sie einen neuen Link an."};if(r.includes("auth/weak-password"))return{success:!1,error:"Das gew\xe4hlte Passwort ist zu schwach. Bitte w\xe4hlen Sie ein st\xe4rkeres Passwort mit mindestens 8 Zeichen."};if(r.includes("auth/user-not-found"))return{success:!1,error:"Der Benutzer wurde nicht gefunden. M\xf6glicherweise wurde das Konto gel\xf6scht."};return{success:!1,error:r}}return{success:!1,error:"Ein unbekannter Fehler ist aufgetreten. Bitte versuchen Sie es sp\xe4ter erneut."}}}async function p(e){try{let r=(0,n.IO)((0,n.hJ)(c,"customers"),(0,n.ar)("uid","==",e)),s=await (0,n.PL)(r);if(s.empty)return null;let t=s.docs[0];return{...t.data(),uid:t.id}}catch(e){return console.error("Fehler beim Abrufen der Kundendaten:",e),null}}async function w(e,r){try{let s=(0,n.IO)((0,n.hJ)(c,"customers"),(0,n.ar)("uid","==",e)),t=await (0,n.PL)(s);if(t.empty)return console.error("Kunde nicht gefunden f\xfcr UID:",e),{success:!1,error:"Kunde nicht gefunden"};let a=t.docs[0],o=a.data();console.log("Aktualisiere Kundendaten:",{docId:a.id,currentData:o,newData:r});let l={...r,uid:o.uid,updatedAt:n.Timestamp.now()};if(await (0,n.updateDoc)((0,n.doc)(c,"customers",a.id),l),r.firstName||r.lastName){let e=u.currentUser;if(e){let s=r.firstName||o.firstName,t=r.lastName||o.lastName;await (0,i.ck)(e,{displayName:`${s} ${t}`})}}if(void 0!==r.profileImageUrl){let e=u.currentUser;e&&await (0,i.ck)(e,{photoURL:r.profileImageUrl||null})}return console.log("Kundendaten erfolgreich aktualisiert"),{success:!0}}catch(e){return console.error("Fehler beim Aktualisieren der Kundendaten:",e),{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}async function b(e,r){try{let s=(0,a.iH)(l,`profileImages/${e}/${r.name}`);await (0,a.KV)(s,r);let t=await (0,a.Jt)(s);return await w(e,{profileImageUrl:t}),{success:!0,url:t}}catch(e){return console.error("Fehler beim Hochladen des Profilbilds:",e),{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}async function y(e){try{let r=(0,n.IO)((0,n.hJ)(c,"customers"),(0,n.ar)("uid","==",e)),s=await (0,n.PL)(r);if(s.empty)return{success:!1,error:"Kunde nicht gefunden"};let t=s.docs[0],o=t.data();if(o.profileImageUrl)try{let e=new URL(o.profileImageUrl).pathname.split("/o/")[1];if(e){let r=decodeURIComponent(e.split("?")[0]),s=(0,a.iH)(l,r);await (0,a.oq)(s)}}catch(e){console.warn("Fehler beim L\xf6schen des Bildes aus dem Storage:",e)}await (0,n.updateDoc)((0,n.doc)(c,"customers",t.id),{profileImageUrl:null,updatedAt:n.Timestamp.now()});let d=u.currentUser;return d&&await (0,i.ck)(d,{photoURL:null}),{success:!0}}catch(e){return console.error("Fehler beim L\xf6schen des Profilbilds:",e),{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}async function k(e){try{let r;if("google.com"===e)(r=new i.hJ).addScope("profile"),r.addScope("email");else throw Error("Nicht unterst\xfctzter Anbieter");let s=(await (0,i.rh)(u,r)).user;if(!await p(s.uid)){let[e,...r]=s.displayName?.split(" ")||["Kunde",""],t=r.join(" ")||"";await (0,n.ET)((0,n.hJ)(c,"customers"),{uid:s.uid,firstName:e,lastName:t,email:s.email||"",phone:s.phoneNumber||"",profileImageUrl:s.photoURL||null,birthdate:"",createdAt:n.Timestamp.now(),updatedAt:n.Timestamp.now()})}return{success:!0,user:s}}catch(r){return console.error(`Fehler bei der Anmeldung mit ${e}:`,r),{success:!1,error:r instanceof Error?r.message:"Unbekannter Fehler"}}}async function U(e){try{await y(e);let r=(0,n.IO)((0,n.hJ)(c,"customers"),(0,n.ar)("uid","==",e)),s=await (0,n.PL)(r);if(!s.empty){let e=s.docs[0];await (0,n.oe)((0,n.doc)(c,"customers",e.id))}let t=u.currentUser;if(!t)return{success:!1,error:"Benutzer nicht authentifiziert"};return await (0,i.h8)(t),{success:!0}}catch(e){return console.error("Fehler beim L\xf6schen des Benutzerkontos:",e),{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}}};