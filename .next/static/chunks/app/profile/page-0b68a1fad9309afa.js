(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{9806:function(e,s,n){Promise.resolve().then(n.bind(n,5520))},5520:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return p}});var t=n(7437),r=n(2265),i=n(9376),l=n(3145),a=n(6108),c=n(7644),o=n(3301),d=n(7648),h=n(5978),x=n(8114),m=n(1405);function u(){let[e,s]=(0,r.useState)(null),[n,u]=(0,r.useState)(null),[g,j]=(0,r.useState)(!0),[p,b]=(0,r.useState)(!1),[f,N]=(0,r.useState)({}),[v,w]=(0,r.useState)(null),[k,y]=(0,r.useState)(null),[B,L]=(0,r.useState)(null),[S,C]=(0,r.useState)(null),[D,F]=(0,r.useState)(!1),[T,E]=(0,r.useState)({}),[z,M]=(0,r.useState)({past:[],upcoming:[],totalCount:0}),[W,R]=(0,r.useState)("profile"),A=(0,r.useRef)(null),P=(0,i.useRouter)(),[H,I]=(0,r.useState)(!1),[Z,V]=(0,r.useState)(null),[K,O]=(0,r.useState)(""),[G,U]=(0,r.useState)(null),[_,q]=(0,r.useState)(null),[$,J]=(0,r.useState)(!1),Q=e=>{if(!e)return"";try{let[s,n,t]=e.split("-");if(!s||!n||!t)return console.error("Ung\xfcltiges Datumsformat:",e),e;return"".concat(t,".").concat(n,".").concat(s)}catch(s){return console.error("Fehler beim Formatieren des Datums:",s),e}},X=async()=>{try{console.log("=========== BUCHUNGEN ABRUFEN START ==========="),new Date().setHours(0,0,0,0);let s=a.I8.currentUser;if(!s){console.error("Kein Benutzer angemeldet");return}console.log("Suche Buchungen f\xfcr:",{uid:s.uid,email:s.email});let n=(0,h.hJ)(a.db,"bookings"),t=(0,h.IO)(n,(0,h.ar)("email","==",s.email)),r=await (0,h.PL)(t);console.log("Gefunden: ".concat(r.size," Buchungen f\xfcr E-Mail ").concat(s.email));let i=new Map;r.forEach(e=>{let s={id:e.id,...e.data()},n=e.id;i.has(n)||(i.set(n,s),console.log("Neue Buchung gefunden:",{id:e.id,date:s.date,time:s.time,service:s.serviceName,email:s.email,status:s.status}))}),console.log("Insgesamt ".concat(i.size," eindeutige Buchungen gefunden"));let l=[],c=[];i.forEach(e=>{let[s,n,t]=e.date.split("-").map(Number),r=new Date(s,n-1,t,12,0,0),i=new Date;i.setHours(12,0,0,0),r<i?(l.push(e),console.log("Vergangene Buchung:",e.date,e.serviceName)):(c.push(e),console.log("Zuk\xfcnftige Buchung:",e.date,e.serviceName))}),l.sort((e,s)=>{let[n,t,r]=e.date.split("-").map(Number),[i,l,a]=s.date.split("-").map(Number),c=new Date(n,t-1,r,12,0,0);return new Date(i,l-1,a,12,0,0).getTime()-c.getTime()}),c.sort((e,s)=>{let[n,t,r]=e.date.split("-").map(Number),[i,l,a]=s.date.split("-").map(Number),c=new Date(n,t-1,r,12,0,0),o=new Date(i,l-1,a,12,0,0);return c.getTime()-o.getTime()}),console.log("Gefunden: ".concat(l.length," vergangene und ").concat(c.length," zuk\xfcnftige Buchungen")),M({past:l,upcoming:c,totalCount:i.size}),e&&await Y(),j(!1)}catch(e){console.error("Fehler beim Abrufen der Buchungen:",e),j(!1)}},Y=async()=>{if(e)try{J(!0);let s=await (0,m.Gf)(e.uid);if(U(s),null==n?void 0:n.birthdate){let s=await (0,m.h1)(e.uid);q(s)}}catch(e){console.error("Fehler beim Laden der Rabattdaten:",e)}finally{J(!1)}};(0,r.useEffect)(()=>{let e=(0,o.Aj)(a.I8,async e=>{if(s(e),e)try{let s=await (0,a.Rf)(e.uid);u(s),await X(),await Y()}catch(e){console.error("Fehler beim Laden der Benutzerdaten:",e),L("Fehler beim Laden Ihrer Daten. Bitte versuchen Sie es sp\xe4ter erneut.")}finally{j(!1)}else j(!1),P.push("/login")});return()=>e()},[P]),(0,r.useEffect)(()=>{e&&n&&Y()},[e,n]);let ee=e=>{let{name:s,value:n}=e.target;("firstName"===s||"lastName"===s)&&(/^[a-zA-ZäöüÄÖÜß\s\-]*$/.test(n)?E(e=>{let n={...e};return delete n[s],n}):E(e=>({...e,[s]:"Bitte nur Buchstaben eingeben"}))),"phone"===s&&(/^[0-9\+\s]*$/.test(n)?E(e=>{let n={...e};return delete n[s],n}):E(e=>({...e,[s]:"Bitte nur Zahlen eingeben"}))),N(e=>({...e,[s]:n}))},es=async()=>{if(e){L(null),C(null);try{let s=await (0,a.Oy)(e.uid);if(!s.success){L(s.error||"Fehler beim L\xf6schen des Profilbilds.");return}w(null),y(null);let n=await (0,a.Rf)(e.uid);u(n),C("Profilbild erfolgreich gel\xf6scht!")}catch(e){L("Ein unerwarteter Fehler ist aufgetreten. Bitte versuchen Sie es sp\xe4ter erneut."),console.error("Fehler beim L\xf6schen des Profilbilds:",e)}}},en=async()=>{if(e){if(L(null),C(null),Object.keys(T).length>0){L("Bitte korrigieren Sie die Eingabefehler, bevor Sie speichern.");return}try{if(Object.keys(f).length>0){console.log("Aktualisiere Kundendaten:",f);let s=await (0,a.mU)(e.uid,f);if(!s.success){L(s.error||"Fehler beim Aktualisieren der Daten.");return}}if(v){console.log("Lade Profilbild hoch");let s=await (0,a._p)(e.uid,v);if(!s.success){L("Daten wurden aktualisiert, aber das Profilbild konnte nicht hochgeladen werden.");return}y(s.url||null)}console.log("Lade aktualisierte Kundendaten");let s=await (0,a.Rf)(e.uid);u(s),C("Profil erfolgreich aktualisiert!"),b(!1)}catch(e){console.error("Fehler beim Aktualisieren des Profils:",e),L("Ein unerwarteter Fehler ist aufgetreten. Bitte versuchen Sie es sp\xe4ter erneut.")}}},et=async()=>{try{await (0,a.$1)(),P.push("/")}catch(e){console.error("Fehler beim Abmelden:",e)}},er=async()=>{if(e){if(L(null),C(null),D)try{let s=await (0,a.rl)(e.uid);if(!s.success){L(s.error||"Fehler beim L\xf6schen des Kontos.");return}P.push("/")}catch(e){L("Ein unerwarteter Fehler ist aufgetreten. Bitte versuchen Sie es sp\xe4ter erneut."),console.error("Fehler beim L\xf6schen des Kontos:",e)}finally{F(!1)}else F(!0)}},ei=async e=>{if(!(0,x.m1)(e.date,e.time)){V(e),O("Buchungen k\xf6nnen nur bis 24 Stunden vor dem Termin storniert werden."),I(!0);return}V(e),O(""),I(!0)},el=async()=>{if(Z)try{let s="cancelled"===Z.status;if(await (0,x.i1)(Z.id,"cancelled")){if(s)try{console.log("\uD83E\uDDEA TEST: Behandlungsz\xe4hler-Reduktion f\xfcr bereits stornierte Buchung:",Z.id),await (0,m.HZ)(Z.id),console.log("✅ TEST: Behandlungsz\xe4hler-Reduktion getestet")}catch(e){console.error("❌ TEST: Fehler beim Testen der Z\xe4hler-Reduktion:",e)}else try{console.log("\uD83D\uDD3B Reduziere Behandlungsz\xe4hler f\xfcr neu stornierte Buchung:",Z.id),await (0,m.HZ)(Z.id),console.log("✅ Behandlungsz\xe4hler erfolgreich reduziert")}catch(e){console.error("❌ Fehler beim Reduzieren des Z\xe4hlers:",e)}if(null==e?void 0:e.uid)try{console.log("\uD83D\uDD04 Starte Neuberechnung nach Stornierung..."),await (0,m.f6)(e.uid),console.log("✅ Neuberechnung abgeschlossen")}catch(e){console.error("❌ Fehler bei der Neuberechnung:",e)}if(await X(),null==e?void 0:e.uid)try{let s=await (0,m.Gf)(e.uid);U(s)}catch(e){console.error("Fehler beim Neuladen des Loyalty-Fortschritts:",e)}I(!1),V(null),O("")}else O("Die Buchung konnte nicht storniert werden. Bitte versuchen Sie es sp\xe4ter erneut.")}catch(e){console.error("Fehler beim Stornieren der Buchung:",e),O("Ein Fehler ist aufgetreten. Bitte versuchen Sie es sp\xe4ter erneut.")}},ea=(e,s)=>{let n=(0,c.jE)(e.price);return(0,t.jsxs)("div",{className:"booking-item p-6 bg-white rounded-lg shadow-sm mb-4",children:[(0,t.jsxs)("div",{className:"booking-card-header",children:[(0,t.jsxs)("div",{className:"booking-date-time",children:[(0,t.jsxs)("div",{className:"booking-date flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,t.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,t.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,t.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),Q(e.date)]}),(0,t.jsxs)("div",{className:"booking-time flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("polyline",{points:"12 6 12 12 16 14"})]}),e.time," Uhr"]})]}),(0,t.jsx)("div",{className:"booking-status",children:(0,t.jsx)("span",{className:"status-badge ".concat("confirmed"===e.status?"status-confirmed":"cancelled"===e.status?"status-cancelled":"status-pending"),children:"confirmed"===e.status?"Best\xe4tigt":"cancelled"===e.status?"Storniert":"Ausstehend"})})]}),(0,t.jsxs)("div",{className:"booking-details",children:[(0,t.jsx)("div",{className:"booking-treatments",children:e.treatments&&e.treatments.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("h4",{className:"booking-service-title flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"}),(0,t.jsx)("line",{x1:"16",y1:"8",x2:"2",y2:"22"}),(0,t.jsx)("line",{x1:"17.5",y1:"15",x2:"9",y2:"15"})]}),"Behandlung:"]}),(0,t.jsx)("ul",{className:"booking-treatments-list",children:e.treatments.map((s,n)=>(0,t.jsxs)("li",{className:"booking-treatment-item",children:[(0,t.jsx)("span",{className:"treatment-name",children:s.name}),(0,t.jsxs)("span",{className:"treatment-duration flex items-center gap-1",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-gray-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("polyline",{points:"12 6 12 12 16 14"})]}),s.duration," Min."]})]},"".concat(e.id,"-").concat(s.id,"-").concat(n)))})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("h4",{className:"booking-service-title flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"}),(0,t.jsx)("line",{x1:"16",y1:"8",x2:"2",y2:"22"}),(0,t.jsx)("line",{x1:"17.5",y1:"15",x2:"9",y2:"15"})]}),"Behandlung:"]}),(0,t.jsx)("div",{className:"booking-service-name",children:e.serviceName})]})}),(0,t.jsxs)("div",{className:"booking-price-duration",children:[(0,t.jsxs)("div",{className:"booking-price flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-[#28a745] font-semibold",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),(0,t.jsx)("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),n.grossFormatted]}),(0,t.jsxs)("div",{className:"price-details text-xs text-gray-500 mt-1",children:[(0,t.jsxs)("div",{children:["Netto: ",n.netFormatted]}),(0,t.jsxs)("div",{children:["MwSt (19%): ",n.vatFormatted]})]})]}),(0,t.jsxs)("div",{className:"booking-duration flex items-center gap-1 text-gray-600",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("polyline",{points:"12 6 12 12 16 14"})]}),e.duration," Min."]})]})]}),(0,t.jsx)("div",{className:"booking-actions",children:"cancelled"===e.status?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-red-500 text-sm font-medium",children:"✅ BEREITS STORNIERT"}),(0,t.jsxs)("button",{onClick:()=>ei(e),className:"btn-cancel-booking flex items-center gap-1 opacity-60",title:"TEST: Z\xe4hler-Reduktion bei bereits stornierten Buchungen",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,t.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),"TEST: Z\xe4hler reduzieren"]})]}):s?null:(0,t.jsxs)("button",{onClick:()=>ei(e),className:"btn-cancel-booking flex items-center gap-1",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,t.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),"Termin stornieren"]})})]})};return g?(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center py-20",children:[(0,t.jsx)("div",{className:"w-24 h-24 relative",children:(0,t.jsxs)("svg",{className:"animate-spin w-full h-full text-b2d8db",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"#b2d8db",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"#b2d8db",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,t.jsx)("p",{className:"mt-8 text-2xl text-gray-600 font-medium",children:"Daten werden geladen..."})]}):e&&n?(0,t.jsxs)("div",{className:"profile-card relative",children:[B&&(0,t.jsxs)("div",{className:"form-feedback error",children:[(0,t.jsx)("strong",{children:"Fehler:"})," ",B]}),S&&(0,t.jsxs)("div",{className:"form-feedback success",children:[(0,t.jsx)("strong",{children:"Erfolg!"})," ",S]}),D&&(0,t.jsxs)("div",{className:"delete-warning",children:[(0,t.jsx)("h3",{className:"delete-warning-title",children:"Warnung: Konto l\xf6schen?"}),(0,t.jsx)("p",{className:"delete-warning-text",children:"Wenn Sie Ihr Konto l\xf6schen, gehen alle Ihre pers\xf6nlichen Daten unwiderruflich verloren."}),(0,t.jsxs)("div",{className:"delete-warning-buttons",children:[(0,t.jsx)("button",{onClick:er,className:"btn--danger",children:"Konto endg\xfcltig l\xf6schen"}),(0,t.jsx)("button",{onClick:()=>{F(!1)},className:"btn--cancel",children:"Abbrechen"})]})]}),(0,t.jsxs)("div",{className:"profile-tabs",children:[(0,t.jsxs)("button",{className:"profile-tab ".concat("profile"===W?"active":""),onClick:()=>R("profile"),children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,t.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}),"Mein Profil"]}),(0,t.jsxs)("button",{className:"profile-tab ".concat("bookings"===W?"active":""),onClick:()=>R("bookings"),children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,t.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,t.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,t.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Meine Buchungen",z.totalCount>0&&(0,t.jsx)("span",{className:"booking-count",children:z.totalCount})]})]}),"profile"===W?(0,t.jsx)("div",{className:"profile-content bg-white rounded-b-lg",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-8",children:[(0,t.jsxs)("div",{className:"profile-image-container",children:[(0,t.jsx)("div",{className:"profile-image relative rounded-full overflow-hidden shadow-md border-4 border-[#e8f3f4]",children:k?(0,t.jsx)(l.default,{src:k,alt:"Profilbild",fill:!0,style:{objectFit:"cover"}}):(0,t.jsx)("div",{className:"w-full h-full bg-[#e8f3f4] flex items-center justify-center rounded-full",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-24 w-24 md:h-32 md:w-32 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,t.jsx)("circle",{cx:"12",cy:"7",r:"4"})]})})}),p&&(0,t.jsxs)("div",{className:"w-full mt-4 flex flex-col gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=A.current)||void 0===e?void 0:e.click()},className:"btn--edit w-full",children:"Profilbild \xe4ndern"}),k&&(0,t.jsx)("button",{type:"button",onClick:es,className:"btn--logout w-full",children:"Profilbild entfernen"}),(0,t.jsx)("input",{ref:A,type:"file",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files[0]){let s=e.target.files[0];w(s);let n=new FileReader;n.onload=e=>{e.target&&"string"==typeof e.target.result&&y(e.target.result)},n.readAsDataURL(s)}},className:"hidden"})]}),(0,t.jsxs)("div",{className:"text-center mt-6 mb-4",children:[(0,t.jsxs)("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:[null==n?void 0:n.firstName," ",null==n?void 0:n.lastName]}),(0,t.jsxs)("p",{className:"text-base text-gray-600 flex items-center justify-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-[#b2d8db]",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,t.jsx)("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),(0,t.jsx)("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),null==n?void 0:n.email]})]}),(0,t.jsxs)("div",{className:"w-full mt-8",children:[(0,t.jsx)("button",{onClick:et,className:"btn--logout w-full",children:"Abmelden"}),(0,t.jsx)("button",{onClick:er,className:"btn--delete w-full mt-4",children:"Konto l\xf6schen"})]})]}),(0,t.jsxs)("div",{className:"profile-details bg-white p-6 rounded-lg shadow-sm border border-gray-100",children:[(0,t.jsx)("h3",{className:"profile-details-title",children:"Pers\xf6nliche Daten"}),(0,t.jsx)("div",{className:"profile-details-content",children:p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"profile-details-grid",children:[(0,t.jsxs)("div",{className:"profile-detail-item",children:[(0,t.jsx)("label",{htmlFor:"firstName",className:"block text-base md:text-lg font-medium text-gray-700 mb-2",children:"Vorname"}),(0,t.jsx)("input",{id:"firstName",name:"firstName",type:"text",value:f.firstName||"",onChange:ee,className:"login-input ".concat(T.firstName?"border-red-500":"")}),T.firstName&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:T.firstName})]}),(0,t.jsxs)("div",{className:"profile-detail-item",children:[(0,t.jsx)("label",{htmlFor:"lastName",className:"block text-base md:text-lg font-medium text-gray-700 mb-2",children:"Nachname"}),(0,t.jsx)("input",{id:"lastName",name:"lastName",type:"text",value:f.lastName||"",onChange:ee,className:"login-input ".concat(T.lastName?"border-red-500":"")}),T.lastName&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:T.lastName})]}),(0,t.jsxs)("div",{className:"profile-detail-item",children:[(0,t.jsx)("label",{htmlFor:"phone",className:"block text-base md:text-lg font-medium text-gray-700 mb-2",children:"Telefonnummer"}),(0,t.jsx)("input",{id:"phone",name:"phone",type:"tel",value:f.phone||"",onChange:ee,className:"login-input ".concat(T.phone?"border-red-500":"")}),T.phone&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:T.phone})]}),(0,t.jsxs)("div",{className:"profile-detail-item",children:[(0,t.jsx)("label",{htmlFor:"birthdate",className:"block text-base md:text-lg font-medium text-gray-700 mb-2",children:"Geburtsdatum"}),(0,t.jsx)("input",{id:"birthdate",name:"birthdate",type:"date",value:f.birthdate||"",onChange:ee,className:"login-input"})]})]}),(0,t.jsxs)("div",{className:"profile-actions",children:[(0,t.jsx)("button",{onClick:en,className:"btn--edit",disabled:Object.keys(T).length>0,style:{opacity:Object.keys(T).length>0?.7:1,cursor:Object.keys(T).length>0?"not-allowed":"pointer"},children:"Profil speichern"}),(0,t.jsx)("button",{onClick:()=>{n&&(N({firstName:n.firstName||"",lastName:n.lastName||"",email:n.email||"",phone:n.phone||"",birthdate:n.birthdate||""}),y(n.profileImageUrl||null),w(null)),b(!1),L(null),C(null)},className:"btn--logout",children:"Abbrechen"})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"profile-details-grid",children:[(0,t.jsxs)("div",{className:"profile-detail-item bg-[#f8f9fa] p-4 rounded-lg",children:[(0,t.jsxs)("h4",{className:"flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,t.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}),"Vorname"]}),(0,t.jsx)("p",{children:null==n?void 0:n.firstName})]}),(0,t.jsxs)("div",{className:"profile-detail-item bg-[#f8f9fa] p-4 rounded-lg",children:[(0,t.jsxs)("h4",{className:"flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,t.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}),"Nachname"]}),(0,t.jsx)("p",{children:null==n?void 0:n.lastName})]}),(0,t.jsxs)("div",{className:"profile-detail-item bg-[#f8f9fa] p-4 rounded-lg",children:[(0,t.jsxs)("h4",{className:"flex items-center gap-2",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,t.jsx)("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),"Telefonnummer"]}),(0,t.jsx)("p",{children:(null==n?void 0:n.phone)||"Nicht angegeben"})]}),(0,t.jsxs)("div",{className:"profile-detail-item bg-[#f8f9fa] p-4 rounded-lg",children:[(0,t.jsxs)("h4",{className:"flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,t.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,t.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,t.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Geburtsdatum"]}),(0,t.jsx)("p",{children:(null==n?void 0:n.birthdate)?new Date(n.birthdate).toLocaleDateString("de-DE"):"Nicht angegeben"})]}),(0,t.jsxs)("div",{className:"profile-detail-item bg-[#f8f9fa] p-4 rounded-lg",children:[(0,t.jsxs)("h4",{className:"flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),(0,t.jsx)("polyline",{points:"22,6 12,13 2,6"})]}),"E-Mail"]}),(0,t.jsx)("p",{children:null==n?void 0:n.email})]})]}),(0,t.jsx)("div",{className:"profile-actions mt-6",children:(0,t.jsxs)("button",{onClick:()=>{n&&(N({firstName:n.firstName||"",lastName:n.lastName||"",email:n.email||"",phone:n.phone||"",birthdate:n.birthdate||""}),b(!0))},className:"btn--edit flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,t.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),"Profil bearbeiten"]})})]})})]})]})}):(0,t.jsxs)("div",{className:"bookings-content bg-white rounded-b-lg",children:[(0,t.jsx)("div",{className:"loyalty-progress-section",children:(0,t.jsxs)("div",{className:"loyalty-progress-card",children:[(0,t.jsxs)("div",{className:"loyalty-header",children:[(0,t.jsx)("div",{className:"loyalty-icon",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,t.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),(0,t.jsxs)("div",{className:"loyalty-title",children:[(0,t.jsx)("h3",{children:"⭐ Treuerabatt-Fortschritt"}),(0,t.jsx)("p",{children:"Sammeln Sie Behandlungen f\xfcr 20% Rabatt"})]})]}),$?(0,t.jsxs)("div",{className:"loyalty-loading",children:[(0,t.jsx)("div",{className:"spinner"}),(0,t.jsx)("p",{children:"Lade Rabattdaten..."})]}):G?(0,t.jsx)(t.Fragment,{children:G.isEligible?(0,t.jsxs)("div",{className:"loyalty-eligible",children:[(0,t.jsx)("div",{className:"celebration-badge",children:"\uD83C\uDF89"}),(0,t.jsx)("h4",{children:"Herzlichen Gl\xfcckwunsch!"}),(0,t.jsxs)("p",{children:["Sie sind berechtigt f\xfcr ",(0,t.jsx)("strong",{children:"20% Treuerabatt"})," ","bei Ihrer n\xe4chsten Buchung!"]})]}):G.lastDiscountDate?(0,t.jsxs)("div",{className:"loyalty-reset",children:[(0,t.jsxs)("div",{className:"reset-info",children:[(0,t.jsx)("div",{className:"reset-icon",children:"✅"}),(0,t.jsxs)("div",{className:"reset-content",children:[(0,t.jsx)("h4",{children:"Treuerabatt verwendet!"}),(0,t.jsxs)("p",{className:"reset-description",children:["Sie haben am"," ",(0,t.jsx)("strong",{children:new Date(G.lastDiscountDate).toLocaleDateString("de-DE")})," ","Ihren 20% Treuerabatt eingel\xf6st."]}),(0,t.jsx)("p",{className:"reset-restart",children:"\uD83D\uDD04 Die Z\xe4hlung f\xfcr Ihren n\xe4chsten Treuerabatt hat neu begonnen!"})]})]}),(0,t.jsxs)("div",{className:"progress-section",children:[(0,t.jsxs)("div",{className:"progress-info",children:[(0,t.jsxs)("span",{className:"progress-numbers",children:[G.progress.current," /"," ",G.progress.required," Behandlungen"]}),(0,t.jsx)("span",{className:"progress-text",children:"f\xfcr den n\xe4chsten Treuerabatt"})]}),(0,t.jsx)("div",{className:"progress-bar-container",children:(0,t.jsx)("div",{className:"progress-bar",children:(0,t.jsx)("div",{className:"progress-fill",style:{width:"".concat(G.progress.current/G.progress.required*100,"%")}})})}),(0,t.jsxs)("div",{className:"progress-remaining",children:[(0,t.jsxs)("span",{className:"remaining-count",children:["Noch ",G.progress.remaining," ","Behandlungen"]}),(0,t.jsx)("span",{className:"remaining-text",children:"bis zu Ihrem n\xe4chsten 20% Rabatt!"})]})]})]}):(0,t.jsxs)("div",{className:"loyalty-progress",children:[(0,t.jsxs)("div",{className:"progress-info",children:[(0,t.jsxs)("span",{className:"progress-numbers",children:[G.progress.current," /"," ",G.progress.required," Behandlungen"]}),(0,t.jsx)("span",{className:"progress-text",children:"in den letzten 6 Monaten"})]}),(0,t.jsx)("div",{className:"progress-bar-container",children:(0,t.jsx)("div",{className:"progress-bar",children:(0,t.jsx)("div",{className:"progress-fill",style:{width:"".concat(G.progress.current/G.progress.required*100,"%")}})})}),(0,t.jsxs)("div",{className:"progress-remaining",children:[(0,t.jsxs)("span",{className:"remaining-count",children:["Noch ",G.progress.remaining," Behandlungen"]}),(0,t.jsx)("span",{className:"remaining-text",children:"bis zu 20% Rabatt!"})]})]})}):(0,t.jsx)("div",{className:"loyalty-error",children:(0,t.jsx)("p",{children:"Rabattdaten konnten nicht geladen werden."})}),(null==_?void 0:_.isEligible)&&(0,t.jsxs)("div",{className:"birthday-bonus",children:[(0,t.jsx)("div",{className:"birthday-icon",children:"\uD83C\uDF82"}),(0,t.jsxs)("div",{className:"birthday-text",children:[(0,t.jsx)("h4",{children:"Happy Birthday!"}),(0,t.jsxs)("p",{children:["Sie erhalten diese Woche"," ",(0,t.jsx)("strong",{children:"10% Geburtstagsrabatt"})," auf alle Buchungen!"]})]})]})]})}),(0,t.jsxs)("div",{className:"bookings-section",children:[(0,t.jsxs)("h3",{className:"bookings-section-title flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,t.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,t.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,t.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Kommende Termine"]}),z.upcoming.length>0?(0,t.jsx)("div",{className:"bookings-list",children:z.upcoming.map(e=>ea(e,!1))}):(0,t.jsxs)("div",{className:"no-bookings",children:[(0,t.jsx)("p",{children:"Sie haben keine kommenden Termine."}),(0,t.jsx)(d.default,{href:"/booking",className:"btn-book-new",children:"Neuen Termin buchen"})]})]}),(0,t.jsxs)("div",{className:"bookings-section",children:[(0,t.jsxs)("h3",{className:"bookings-section-title flex items-center gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-[#b2d8db]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,t.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),"Vergangene Termine"]}),z.past.length>0?(0,t.jsx)("div",{className:"bookings-list",children:z.past.map(e=>ea(e,!0))}):(0,t.jsx)("div",{className:"no-bookings",children:(0,t.jsx)("p",{children:"Sie haben noch keine vergangenen Termine."})})]})]}),H?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-md w-full mx-4",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-4 text-red-600",children:K?"Stornierung nicht m\xf6glich":"Buchung stornieren"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:K||"M\xf6chten Sie diese Buchung wirklich stornieren? Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden."}),(0,t.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,t.jsx)("button",{onClick:()=>{I(!1),V(null),O("")},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:K?"Schlie\xdfen":"Abbrechen"}),!K&&Z&&(0,t.jsx)("button",{onClick:el,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Ja, stornieren"})]})]})}):null]}):(0,t.jsx)("div",{className:"profile-card",children:(0,t.jsxs)("div",{className:"profile-content text-center py-12 px-6 md:px-12",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-28 w-28 text-[#b2d8db]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),(0,t.jsx)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),(0,t.jsx)("h2",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Sie sind nicht angemeldet"}),(0,t.jsx)("p",{className:"text-xl text-gray-600 mb-10",children:"Bitte melden Sie sich an, um Ihr Profil zu sehen."}),(0,t.jsx)("button",{onClick:()=>P.push("/login"),className:"btn--form",children:"Zur Anmeldung"})]})})}n(661);var g=n(9295),j=n(2834);function p(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Z,{}),(0,t.jsx)("main",{className:"main",children:(0,t.jsx)("section",{className:"section-profile py-12 md:py-20",children:(0,t.jsxs)("div",{className:"container",children:[(0,t.jsxs)("div",{className:"profile-header mb-8 text-center",children:[(0,t.jsx)("h1",{className:"heading-primary mb-4",children:"Mein Profil"}),(0,t.jsx)("p",{className:"text-gray-600 mb-8",children:"Verwalten Sie Ihre pers\xf6nlichen Daten und sehen Sie Ihre Buchungen."})]}),(0,t.jsx)(u,{})]})})}),(0,t.jsx)(j.Z,{})]})}},661:function(){}},function(e){e.O(0,[564,358,657,432,648,145,108,354,763,394,971,117,744],function(){return e(e.s=9806)}),_N_E=e.O()}]);