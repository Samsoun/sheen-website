"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[108],{6108:function(e,r,t){t.d(r,{$1:function(){return m},I8:function(){return l},IG:function(){return U},LG:function(){return p},Oy:function(){return y},Rf:function(){return w},UJ:function(){return f},WL:function(){return h},_p:function(){return k},c0:function(){return g},db:function(){return o},mU:function(){return b},rl:function(){return I}});var n=t(738),s=t(5978),i=t(3301),a=t(62),c=t(6834);let u=(0,n.ZF)({apiKey:"AIzaSyB7tnzEzeRBqQ1JL8aNgRe2PPuOS0Mt5Ms",authDomain:"sheen-termin.firebaseapp.com",projectId:"sheen-termin",storageBucket:"sheen-termin.firebasestorage.app",messagingSenderId:"531525100411",appId:"1:531525100411:web:59b8c142e3deca949613de",measurementId:"G-F69XYP1FV5"}),o=(0,s.ad)(u),l=(0,i.v0)(u),d=(0,a.cF)(u);async function f(e,r,t){try{let n=(await (0,i.Xb)(l,e,r)).user,a=t.profileImageUrl;return await (0,i.ck)(n,{displayName:"".concat(t.firstName," ").concat(t.lastName),photoURL:a||null}),await (0,s.ET)((0,s.hJ)(o,"customers"),{uid:n.uid,firstName:t.firstName,lastName:t.lastName,phone:t.phone,email:t.email,birthdate:t.birthdate,profileImageUrl:a||null,createdAt:s.Timestamp.now(),updatedAt:s.Timestamp.now()}),{success:!0,uid:n.uid}}catch(e){if(console.error("Fehler bei der Kundenregistrierung:",e),e instanceof Error){let r=e.message;if(r.includes("auth/email-already-in-use"))return{success:!1,error:"auth/email-already-in-use"};if(r.includes("auth/weak-password"))return{success:!1,error:"Das Passwort ist zu schwach. Bitte w\xe4hlen Sie ein st\xe4rkeres Passwort."};if(r.includes("auth/invalid-email"))return{success:!1,error:"Die E-Mail-Adresse ist ung\xfcltig. Bitte geben Sie eine g\xfcltige E-Mail-Adresse ein."};return{success:!1,error:r}}return{success:!1,error:"Unbekannter Fehler bei der Registrierung"}}}async function h(e,r){try{let t=await (0,i.e5)(l,e,r);return{success:!0,user:t.user}}catch(e){return console.error("Fehler bei der Anmeldung:",e),{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}async function m(){try{return await (0,i.w7)(l),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}async function g(e){try{let r={url:"".concat(window.location.origin,"/login"),handleCodeInApp:!1};return console.log("Reset-Link wird gesendet an:",e),console.log("Mit Weiterleitung zu:",r.url),await (0,i.LS)(l,e,r),console.log("Reset-Link erfolgreich gesendet"),{success:!0}}catch(e){if(console.error("Fehler beim Senden des Reset-Links:",e),e instanceof Error){let r=e.message||"";if(r.includes("auth/user-not-found"))return{success:!1,error:"Es wurde kein Konto mit dieser E-Mail-Adresse gefunden."};if(r.includes("auth/invalid-email"))return{success:!1,error:"Die eingegebene E-Mail-Adresse ist ung\xfcltig."};if(r.includes("auth/too-many-requests"))return{success:!1,error:"Zu viele Anfragen. Bitte versuchen Sie es sp\xe4ter erneut."};return{success:!1,error:r}}return{success:!1,error:"Ein unbekannter Fehler ist aufgetreten. Bitte versuchen Sie es sp\xe4ter erneut."}}}async function p(e,r){try{if(!e||""===e.trim())return console.error("Leerer oobCode bei confirmPasswordReset"),{success:!1,error:"Der Reset-Code fehlt oder ist ung\xfcltig. Bitte fordern Sie einen neuen Reset-Link an."};if(!r||r.length<8)return{success:!1,error:"Das Passwort muss mindestens 8 Zeichen lang sein."};return await (0,i.LG)(l,e,r),console.log("Passwort erfolgreich zur\xfcckgesetzt"),{success:!0}}catch(e){if(console.error("Fehler beim Zur\xfccksetzen des Passworts:",e),e instanceof Error){let r=e.message||"";if(r.includes("auth/invalid-action-code")||r.includes("auth/expired-action-code"))return{success:!1,error:"Der Reset-Link ist ung\xfcltig oder abgelaufen. Bitte fordern Sie einen neuen Link an."};if(r.includes("auth/weak-password"))return{success:!1,error:"Das gew\xe4hlte Passwort ist zu schwach. Bitte w\xe4hlen Sie ein st\xe4rkeres Passwort mit mindestens 8 Zeichen."};if(r.includes("auth/user-not-found"))return{success:!1,error:"Der Benutzer wurde nicht gefunden. M\xf6glicherweise wurde das Konto gel\xf6scht."};return{success:!1,error:r}}return{success:!1,error:"Ein unbekannter Fehler ist aufgetreten. Bitte versuchen Sie es sp\xe4ter erneut."}}}async function w(e){try{let r=(0,s.IO)((0,s.hJ)(o,"customers"),(0,s.ar)("uid","==",e)),t=await (0,s.PL)(r);if(t.empty)return null;let n=t.docs[0];return{...n.data(),uid:n.id}}catch(e){return console.error("Fehler beim Abrufen der Kundendaten:",e),null}}async function b(e,r){try{let t=(0,s.IO)((0,s.hJ)(o,"customers"),(0,s.ar)("uid","==",e)),n=await (0,s.PL)(t);if(n.empty)return console.error("Kunde nicht gefunden f\xfcr UID:",e),{success:!1,error:"Kunde nicht gefunden"};let a=n.docs[0],c=a.data();console.log("Aktualisiere Kundendaten:",{docId:a.id,currentData:c,newData:r});let u={...r,uid:c.uid,updatedAt:s.Timestamp.now()};if(await (0,s.updateDoc)((0,s.doc)(o,"customers",a.id),u),r.firstName||r.lastName){let e=l.currentUser;if(e){let t=r.firstName||c.firstName,n=r.lastName||c.lastName;await (0,i.ck)(e,{displayName:"".concat(t," ").concat(n)})}}if(void 0!==r.profileImageUrl){let e=l.currentUser;e&&await (0,i.ck)(e,{photoURL:r.profileImageUrl||null})}return console.log("Kundendaten erfolgreich aktualisiert"),{success:!0}}catch(e){return console.error("Fehler beim Aktualisieren der Kundendaten:",e),{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}async function k(e,r){try{let t=(0,a.iH)(d,"profileImages/".concat(e,"/").concat(r.name));await (0,a.KV)(t,r);let n=await (0,a.Jt)(t);return await b(e,{profileImageUrl:n}),{success:!0,url:n}}catch(e){return console.error("Fehler beim Hochladen des Profilbilds:",e),{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}async function y(e){try{let r=(0,s.IO)((0,s.hJ)(o,"customers"),(0,s.ar)("uid","==",e)),t=await (0,s.PL)(r);if(t.empty)return{success:!1,error:"Kunde nicht gefunden"};let n=t.docs[0],c=n.data();if(c.profileImageUrl)try{let e=new URL(c.profileImageUrl).pathname.split("/o/")[1];if(e){let r=decodeURIComponent(e.split("?")[0]),t=(0,a.iH)(d,r);await (0,a.oq)(t)}}catch(e){console.warn("Fehler beim L\xf6schen des Bildes aus dem Storage:",e)}await (0,s.updateDoc)((0,s.doc)(o,"customers",n.id),{profileImageUrl:null,updatedAt:s.Timestamp.now()});let u=l.currentUser;return u&&await (0,i.ck)(u,{photoURL:null}),{success:!0}}catch(e){return console.error("Fehler beim L\xf6schen des Profilbilds:",e),{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}async function U(e){try{let t;if("google.com"===e)(t=new i.hJ).addScope("profile"),t.addScope("email");else throw Error("Nicht unterst\xfctzter Anbieter");let n=(await (0,i.rh)(l,t)).user;if(!await w(n.uid)){var r;let[e,...t]=(null===(r=n.displayName)||void 0===r?void 0:r.split(" "))||["Kunde",""],i=t.join(" ")||"";await (0,s.ET)((0,s.hJ)(o,"customers"),{uid:n.uid,firstName:e,lastName:i,email:n.email||"",phone:n.phoneNumber||"",profileImageUrl:n.photoURL||null,birthdate:"",createdAt:s.Timestamp.now(),updatedAt:s.Timestamp.now()})}return{success:!0,user:n}}catch(r){return console.error("Fehler bei der Anmeldung mit ".concat(e,":"),r),{success:!1,error:r instanceof Error?r.message:"Unbekannter Fehler"}}}async function I(e){try{await y(e);let r=(0,s.IO)((0,s.hJ)(o,"customers"),(0,s.ar)("uid","==",e)),t=await (0,s.PL)(r);if(!t.empty){let e=t.docs[0];await (0,s.oe)((0,s.doc)(o,"customers",e.id))}let n=l.currentUser;if(!n)return{success:!1,error:"Benutzer nicht authentifiziert"};return await (0,i.h8)(n),{success:!0}}catch(e){return console.error("Fehler beim L\xf6schen des Benutzerkontos:",e),{success:!1,error:e instanceof Error?e.message:"Unbekannter Fehler"}}}(0,c.Gb)().then(e=>e?(0,c.IH)(u):null)}}]);